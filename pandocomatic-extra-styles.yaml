#-----------------------------------------------------------------------------
#:::::::::::::::::::::::::::::::::: PLAIN:::::::::::::::::::::::::::::::::::::
#-----------------------------------------------------------------------------
  plain:
    pandoc:
      from: markdown
      to: plain
      standalone: true
      columns: 80
      filter:
        - filters/prependAbstract #prepends abstract: metadata into the text
        - filters/prependAll #prepends institute:, comments: and keywords: metadata into the text
        - filters/prependAuthor #prepends authors
#----------------------------------------------------------------------------
  plain-refs:
    extends: [refs,plain]

#-----------------------------------------------------------------------------
#:::::::::::::::::::::::::::::::::: HTML :::::::::::::::::::::::::::::::::::::
#-----------------------------------------------------------------------------
  html:
    pandoc:
      from: markdown
      to: html5
      standalone: true
      number-sections: false
      section-divs: true
      mathjax: true
      filter:
        - 'filters/removeHR' #remove horizontal rules
      template: 'templates/custom.html'
      css: ['templates/custom.css']
      dpi: 300
      toc: true
      toc-depth: 3
      base-header-level: 1
    postprocessors: ['postprocessors/fixHTML']
#-----------------------------------------------------------------------------
  html-changes:
    extends: ['html']
    preprocessors: ['preprocessors/criticmarkup']
#-----------------------------------------------------------------------------
  html-refs:
    extends: [refs,'html']
#-----------------------------------------------------------------------------
  html-endnote:
    extends: [refs,'html']
    preprocessors: ['preprocessors/convertEndnoteRefs']
#-----------------------------------------------------------------------------
  html-scholar:
    extends: [refs,'html']
    preprocessors: ['preprocessors/convertEndnoteRefs']
    pandoc:
      template: 'templates/pandoc-scholar.html'
      css: 'templates/pandoc-scholar.css'
#-----------------------------------------------------------------------------
  html-scholar-pdf:
    extends: ['html-scholar']
    pandoc:
      to: pdf
      pdf-engine: prince
      pdf-engine-opt: ['--page-size=letter','--page-margin=10mm']
#-----------------------------------------------------------------------------
  html-pdf:
    extends: ['html']
    pandoc:
      to: pdf
      pdf-engine: prince
      pdf-engine-opt: ['--page-size=A4']
      toc: true
#-----------------------------------------------------------------------------
  html-refs-pdf:
    extends: [refs,'html']
    pandoc:
      to: pdf
      pdf-engine: prince
      pdf-engine-opt: ['--page-size=A4']
#-----------------------------------------------------------------------------
  html-endnote-pdf:
    extends: ['html-refs-pdf']
    preprocessors: ['preprocessors/convertEndnoteRefs']
#-----------------------------------------------------------------------------
  html-selfcontained:
    extends: 'html'
    pandoc:
      self-contained: true
#-----------------------------------------------------------------------------
  tufte:
    pandoc:
      from: markdown+compact_definition_lists
      to: html5
      section-divs: true
      standalone: true
      filter:
        - filters/assimilateMetadata # regularise metadata
        - pandoc-sidenote # brew install jez/formulae/pandoc-sidenote
      template: 'templates/tufte.html5'
      css:
        - 'templates/tufte.css'
        - 'templates/tuftepandoc.css'
#-----------------------------------------------------------------------------
  tufte-refs:
    extends: [refs,'tufte']
#-----------------------------------------------------------------------------
  tufte-refs-pdf:
    extends: [refs,'tufte']
    pandoc:
      to: pdf
      pdf-engine: prince
      pdf-engine-opt: ['--page-size=A4']
#-----------------------------------------------------------------------------
  docx-refs-not-linked:
    extends: [docx,refs]
    metadata:
      link-citations: false
#-----------------------------------------------------------------------------
  docx-endnote:
    extends: [docx,refs]
    preprocessors:
      add: [preprocessors/convertEndnoteRefs] #turns endnote citations to pandoc citations
#-----------------------------------------------------------------------------
  docx-changes:
    extends: [docx,refs]
    preprocessors: [preprocessors/criticmarkup] #process criticmarkup to HTML that pandoc can use
#-----------------------------------------------------------------------------
  odt-refs:
    extends: [docx,refs]
    pandoc:
      to: odt
      reference-doc: templates/custom.odt
#-----------------------------------------------------------------------------



#-----------------------------------------------------------------------------
#:::::::::::::::::::::::::::::: PRESENTATIONS ::::::::::::::::::::::::::::::::
#-----------------------------------------------------------------------------
# Note for reveal.js standalone download the files  and put them
# in a reveal.js/ folder relative to the markdown file.
#   wget https://github.com/hakimel/reveal.js/archive/master.tar.gz
#   tar -xzvf master.tar.gz
#   mv reveal.js-master reveal.js
  revealjs:
    extends: [refs]
    pandoc:
      from: markdown
      to: revealjs
      toc: true
    metadata:
      revealjs-url: http://lab.hakim.se/reveal-js
      slideNumber: true
      transition: fade # none/fade/slide/convex/concave/zoom
      transitionSpeed: default # default/fast/slow
  revealjs-local:
    extends: [revealjs]
    metadata:
      revealjs-url: ./reveal.js
  revealjs-selfcontained:
    extends: [revealjs-local]
    pandoc:
      self-contained: true
  powerpoint:
    extends: [refs]
    pandoc:
      from: markdown
      to: pptx


#-----------------------------------------------------------------------------
  latex-endnotes:
    extends: [latex,refs]
    preprocessors:
      - preprocessors/convertEndnoteRefs
#-----------------------------------------------------------------------------
  latex-chemfig: # example of using header-includes with yaml block scalar data http://yaml-multiline.info/
    extends: [latex,refs]
    metadata:
      header-includes:
        - |
          ```{=latex}
          \usepackage[]{chemfig}
          ```
#-----------------------------------------------------------------------------
  latex-toc:
    extends: [latex,refs]
    pandoc:
      toc: true
      toc-depth: 3
#-----------------------------------------------------------------------------
  pdf-endnotes:
    extends: 'latex-endnotes'
    pandoc:
      to: pdf
      pdf-engine: 'xelatex'
    cleanup: ['latexmk -c']
#-----------------------------------------------------------------------------
  latex-with-lof:
    extends: [latex,refs]
    pandoc:
      toc: true
      toc-depth: 3
      lof: true
# https://github.com/Wandmalfarbe/pandoc-latex-template
  eisvogel-original:
    extends: 'eisvogel'
    pandoc:
      to: pdf
      pdf-engine: 'xelatex'
    cleanup: []

#-----------------------------------------------------------------------------
# https://github.com/Wandmalfarbe/pandoc-latex-template
  eisvogel-endnote:
    extends: 'eisvogel'
    preprocessors:
      - preprocessors/convertEndnoteRefs
#-----------------------------------------------------------------------------
  latex-ieee:
    extends: [latex,refs]
    pandoc:
      template: templates/ieee.latex
    metadata:
      fontsize: '10pt'
#-----------------------------------------------------------------------------
# https://github.com/pandoc-scholar/pandoc-scholar
  latex-scholar:
    extends: [latex,refs]
    pandoc:
      template: templates/pandoc-scholar.latex
    metadata:
      fontsize: '10pt'
#-----------------------------------------------------------------------------
  memoir-with-refs:
    extends: [latex,refs]
    pandoc:
      template: templates/custom-memoir.latex
      toc: true
      toc-depth: 3
      base-header-level: 1
    metadata:
      documentclass: 'memoir'
#-----------------------------------------------------------------------------
#:::::::::::::::::::::::::::::::::: EPUB :::::::::::::::::::::::::::::::::::::
#-----------------------------------------------------------------------------
  epub-test:
    pandoc:
      from: markdown
      to: epub
      standalone: true
      self-contained: true
    metadata:
      stylesheet: epub.css
      cover-image: templates/VPMLogoBlack.png
#-----------------------------------------------------------------------------
#:::::::::::::::::::::::::::::::::: TEST :::::::::::::::::::::::::::::::::::::
#-----------------------------------------------------------------------------
# VARIOUS TEST TEMPLATES
  test:
    pandoc:
      from: markdown
      to: html5
      standalone: true
      css: ['templates/custom.css']
      self-contained: true
      mathjax: true
  test-markdown:
    pandoc:
      from: markdown
      to: markdown
      output: out.md
      standalone: true
      filter: ['filters/testFilter']
    metadata:
        author: Joanna Doe
